# -*-shell-script-*-

[Meta]
RootName: @gnome.org/libgnomesu:$SOFTWAREVERSION
DisplayName: Superuser privilege library
ShortName: libgnomesu
Maintainer: Hongli Lai <h.lai@chello.nl> - http://members1.chello.nl/~h.lai/libgnomesu/
Packager: Hongli Lai <h.lai@chello.nl>
Summary: libgnomesu is a library which allows you to run programs as root or another user.
SoftwareVersion: @VERSION@
InterfaceVersion: 0.1
PackageVersion: 1
RootInstallOnly: Yes
AutopackageTarget: 1.0

[Description]
libgnomesu is a library which allows you to run programs as root or another user.

[BuildPrepare]
prepareBuild --disable-setuid-error --disable-install-pam --enable-binreloc

[BuildUnprepare]
unprepareBuild

[Imports]
chmod +r libexec/*
echo '*' | import
echo "$source_dir/pam-backend/gnomesu-pam" | import

[Prepare]
require @rpm.org/popt 0.0
require @gnome.org/libgnomeui 2.0
require @gnome.org/gconf2 4.0

[Install]
installExe bin/gnomesu

installLib lib/libgnomesu.so.0.1.0
copyFiles lib/libgnomesu.la "$PREFIX/lib"

eprefix=`escapeValue "$PREFIX"`
safeSed lib/pkgconfig/libgnomesu-1.0.pc "s/^prefix=.*/prefix=$eprefix/"
copyFiles lib/pkgconfig/libgnomesu-1.0.pc "$PREFIX/lib/pkgconfig"

copyFiles libexec/{gnomesu-backend,gnomesu-pam-backend} "$PREFIX/libexec"
chown root:root "$PREFIX/libexec/gnomesu-backend" "$PREFIX/libexec/gnomesu-pam-backend"
chmod +s "$PREFIX/libexec/gnomesu-backend" "$PREFIX/libexec/gnomesu-pam-backend"

copyFiles gnomesu-pam /etc/pam.d

copyFiles share/locale/* "$PREFIX/share/locale"

copyFiles include/* "$PREFIX/include"

installGnome2Mime share/mime-info/gnomesu-nautilus.keys
installGnome2AppEntry share/application-registry/gnomesu-nautilus.applications


[Uninstall]
uninstallFromLog
